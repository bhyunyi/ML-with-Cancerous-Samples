"0","# Subset the significant gene data to TF-only rows"
"0","sig_TF_data <- as.data.frame(sig_gene_data %>% filter(GeneID %in% tf_list))"
"0",""
"0","# Set rownames and drop GeneID column"
"0","rownames(sig_TF_data) <- sig_TF_data$GeneID"
"0","sig_TF_data <- sig_TF_data[, -which(names(sig_TF_data) == ""GeneID"")]"
"0",""
"0","# Convert to matrix"
"0","sig_TF_mat <- as.matrix(sig_TF_data)"
"0",""
"0","# Scale the rows (genes)"
"0","sig_TF_mat_scaled <- t(scale(t(sig_TF_mat)))"
"0",""
"0","# Create annotation for samples "
"0","# Make sure it includes only the relevant samples"
"0","annotation_df_TF <- annotation_df[colnames(sig_TF_mat_scaled), , drop = FALSE]"
"0",""
"0","# Plot the heatmap"
"0","pheatmap(sig_TF_mat_scaled,"
"0","         show_rownames = FALSE,"
"0","         show_colnames = TRUE,"
"0","         clustering_distance_rows = ""euclidean"","
"0","         clustering_distance_cols = ""euclidean"","
"0","         clustering_method = ""complete"","
"0","         fontsize_row = 6,"
"0","         fontsize_col = 10,"
"0","         annotation_col = annotation_df_TF,"
"0","         main = ""Clustering of Significant Transcription Factor Genes"")"
"0",""
