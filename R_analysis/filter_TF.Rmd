---
title: "Filtering for Transcription Factors"
author: "Tiffany Tang"
date: "2025-07-17"
output: html_document
---

## Transcription Factor filtering code

the columns of the data frame needed to be filtered based on a list of known transcription factors
so the column names could of had a go term analysis done on it to get a list of transcripts that are transcription factors
then you use that list to filter the master tsv files
just reducing the number of columns to only include transcription factors


Reading in the data
```{r readin}
library(dplyr) # load necessary libraries
library(readr)

# Adjust path variables as needed
# pathBrian <- 
pathTiffany <- "C:\\Users\\tiffa\\OneDrive\\Desktop\\Masters in Bioinformatics\\Transcriptomics\\Final\\transformed_data.tsv"

# load in my data
expr_data <- read_tsv(pathTiffany)
```

Next we need to get a list of transcription factor transcripts. 

This can be done using GO term, 
- do this with biomaRt

```{r Go_list}
library(biomaRt) # instal library

# Lets connect to ensemble
ensembl <- useMart("ensembl", dataset = "hsapiens_gene_ensembl")

#Extract transcript ID's from data, this is from the 4th column onwards
transcript_ids <- colnames(expr_data)[4:ncol(expr_data)]

# Get GO annotations for the transcript IDs
go_annotations <- getBM(
  attributes = c("ensembl_transcript_id", "go_id", "name_1006"),
  filters = "ensembl_transcript_id",
  values = transcript_ids,
  mart = ensembl
)

# Filter for trancsription factors
tf_go <- go_annotations %>%
  filter(grepl("transcription factor", name_1006, ignore.case = TRUE))

# Lets get the list
expr_data_tf <- expr_data %>%
  select(1:3, all_of(intersect(colnames(expr_data), tf_transcripts)))

# just to look 
head(expr_data_tf)
```

Following this we will filter the expression matrix to only keep transcription factors

```{r tf_only}

```

Save the filtered matrix
```{r }
# Please add the path to your variable below
# outpathBrian <- 
outpathTiffany <- "C:\\Users\\tiffa\\OneDrive\\Desktop\\Masters in Bioinformatics\\Transcriptomics\\Final\\tf_filtered.tsv"
```